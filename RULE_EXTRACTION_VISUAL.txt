# Rule Extraction Strategies - Visual Summary

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        IFC File Upload                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Data Layer (Build Graph)                   â”‚
â”‚  Extracts: doors, spaces, elements, properties, spatial     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          extract_rules_from_graph(graph, strategies)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   Strategy 1 â”‚  â”‚   Strategy 2 â”‚  â”‚   Strategy 3 â”‚      â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚      â”‚
â”‚  â”‚  PSet        â”‚  â”‚ Statistical  â”‚  â”‚   Metadata   â”‚      â”‚
â”‚  â”‚  Heuristic   â”‚  â”‚  Baseline    â”‚  â”‚ Completeness â”‚      â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚      â”‚
â”‚  â”‚ â€¢ Scan       â”‚  â”‚ â€¢ Collect    â”‚  â”‚ â€¢ Check for  â”‚      â”‚
â”‚  â”‚   property   â”‚  â”‚   element    â”‚  â”‚   missing    â”‚      â”‚
â”‚  â”‚   sets       â”‚  â”‚   data       â”‚  â”‚   data       â”‚      â”‚
â”‚  â”‚ â€¢ Find min   â”‚  â”‚ â€¢ Calculate  â”‚  â”‚ â€¢ Identify   â”‚      â”‚
â”‚  â”‚   width,     â”‚  â”‚   percentile â”‚  â”‚   gaps       â”‚      â”‚
â”‚  â”‚   area, occ  â”‚  â”‚ â€¢ Generate   â”‚  â”‚ â€¢ Create     â”‚      â”‚
â”‚  â”‚              â”‚  â”‚   baselines  â”‚  â”‚   validation â”‚      â”‚
â”‚  â”‚ Output: 5    â”‚  â”‚              â”‚  â”‚   rules      â”‚      â”‚
â”‚  â”‚ rules        â”‚  â”‚ Output: 2    â”‚  â”‚              â”‚      â”‚
â”‚  â”‚              â”‚  â”‚ rules        â”‚  â”‚ Output: 2    â”‚      â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚ rules        â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â–¼                  â–¼                  â–¼              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Combine & Deduplicate (avoid ID collisions)  â”‚         â”‚
â”‚  â”‚         Total: 9 rules                         â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Rules Manifest JSON                             â”‚
â”‚  {                                                           â”‚
â”‚    "manifest_id": "ifc_rules_manifest_BuildingName",        â”‚
â”‚    "extraction_strategies": ["pset", "statistical",         â”‚
â”‚                               "metadata"],                   â”‚
â”‚    "rules": [                                               â”‚
â”‚      { "id": "IFC_PARAM_...", "name": "...", ... },        â”‚
â”‚      { "id": "STAT_...", "name": "...", ... },             â”‚
â”‚      { "id": "METADATA_...", "name": "...", ... }          â”‚
â”‚    ]                                                         â”‚
â”‚  }                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Frontend Rules Catalogue                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Rules Catalogue                  [9 rules]  â”‚          â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
â”‚  â”‚  [View Catalogue] [Manage]  [Extraction ...] â”‚          â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”‚
â”‚  â”‚  IFC_PARAM_SPACE_MIN_AREA_...    (PSet)      â”‚          â”‚
â”‚  â”‚  STAT_DOOR_WIDTH_10TH_PERCENTILE (Statistical)         â”‚
â”‚  â”‚  METADATA_DOORS_MISSING_WIDTH    (Metadata)  â”‚          â”‚
â”‚  â”‚  ... (6 more)                                â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚  User can: View â†’ Edit â†’ Delete â†’ Append â†’ Save            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## GUI Workflow

```
Start
  â”‚
  â–¼
[Browse IFC] 
  â”‚
  â–¼
[Rule Layer Tab]
  â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                     â”‚
  â–¼                                     â–¼
[View Catalogue]         [Extraction Settings]
  â”‚                             â”‚
  â”œâ”€ See all rules              â”œâ”€ â˜‘ PSet Heuristic
  â”œâ”€ Edit parameters            â”œâ”€ â˜‘ Statistical
  â”œâ”€ Delete unwanted            â”œâ”€ â˜‘ Metadata
  â””â”€ Export to JSON             â”‚
                                â”œâ”€ [Apply]
                                â””â”€ Refresh rules
  â”‚
  â–¼
[Manage Rules]
  â”‚
  â”œâ”€ Import catalogue (fresh)
  â”œâ”€ Append catalogue (merge)
  â”œâ”€ Edit individual rules
  â”œâ”€ Delete rules
  â””â”€ Save to JSON
```

## Strategy Details

### 1ï¸âƒ£ Property Set Heuristic

```
Input:  Graph with property sets
        {
          "doors": [
            { "width_mm": 900, "attributes": { "property_sets": { ... } } }
          ]
        }

Process: Scan each property set for rule-like keywords
         "min_width" â†’ Check: door width rule
         "area" + "m2" â†’ Check: space area rule
         "occupancy" + "max" â†’ Check: building occupancy rule

Output:  [
           {
             "id": "IFC_PARAM_DOOR_MIN_WIDTH_ABC123",
             "name": "Door minimum width",
             "parameters": { "min_width_mm": 900 },
             "severity": "ERROR",
             "code_reference": "IBC 2018",
             "provenance": { "pset": "Pset_DoorCommon" }
           }
         ]

Badge:   ğŸŸ  ORANGE - Direct from IFC property
```

### 2ï¸âƒ£ Statistical Baseline

```
Input:  Graph with element measurements
        {
          "doors": [
            { "width_mm": 850 },
            { "width_mm": 900 },
            { "width_mm": 950 },
            { "width_mm": 900 },
            { "width_mm": 920 },
            { "width_mm": 880 }
          ]
        }

Process: Calculate percentiles from all elements
         Sorted: [850, 880, 900, 900, 920, 950]
         10th percentile: 850mm (min value in building)

Output:  [
           {
             "id": "STAT_DOOR_WIDTH_10TH_PERCENTILE",
             "name": "Door width baseline (10th percentile)",
             "parameters": { "min_width_mm": 850 },
             "severity": "WARNING",  // Less strict than explicit
             "provenance": {
               "source": "statistical_analysis",
               "sample_size": 6,
               "method": "10th_percentile"
             }
           }
         ]

Badge:   ğŸŸ¡ YELLOW - Calculated from building data
```

### 3ï¸âƒ£ Data Completeness

```
Input:  Graph with potential missing data
        {
          "doors": [
            { "id": "Door1", "width_mm": 900 },  âœ“
            { "id": "Door2", "width_mm": null }, âœ—
            { "id": "Door3", "width_mm": null }  âœ—
          ]
        }

Process: Count elements missing required fields
         doors_missing_width = 2

Output:  [
           {
             "id": "METADATA_DOORS_MISSING_WIDTH",
             "name": "Doors missing width data",
             "severity": "INFO",  // Just informational
             "provenance": {
               "source": "metadata_analysis",
               "issue": "2 doors without width data",
               "recommendation": "Add width property sets"
             }
           }
         ]

Badge:   ğŸ”µ BLUE - Data quality warning
```

## Data Flow: Behind the Scenes

```
extract_rules_from_graph(graph, strategies=["pset", "statistical", "metadata"])
â”‚
â”œâ”€ if "pset" in strategies:
â”‚  â””â”€ for each element_type in graph.elements:
â”‚     â””â”€ for each property_set:
â”‚        â””â”€ _heuristic_extract_from_pset() â†’ 5 rules
â”‚
â”œâ”€ if "statistical" in strategies:
â”‚  â””â”€ _extract_statistical_rules(graph)
â”‚     â”œâ”€ Collect all door widths â†’ [850, 880, 900, ...]
â”‚     â”œâ”€ Calculate percentiles
â”‚     â””â”€ Generate baseline rules â†’ 2 rules
â”‚
â”œâ”€ if "metadata" in strategies:
â”‚  â””â”€ _extract_metadata_rules(graph)
â”‚     â”œâ”€ Check for missing widths â†’ 2 doors missing
â”‚     â”œâ”€ Check for missing areas â†’ 3 spaces missing
â”‚     â””â”€ Generate validation rules â†’ 2 rules
â”‚
â””â”€ Combine & deduplicate by ID â†’ 9 total rules
   return manifest
```

## Settings Panel UI

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘       Rule Extraction Strategies           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                             â•‘
â•‘  Select which strategies to use when       â•‘
â•‘  extracting rules from IFC data:           â•‘
â•‘                                             â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ â˜‘ Property Set Heuristic            â”‚  â•‘
â•‘  â”‚   Scans IFC property sets for rule  â”‚  â•‘
â•‘  â”‚   parameters (door widths, etc)     â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                             â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ â˜‘ Statistical Baseline              â”‚  â•‘
â•‘  â”‚   Generates baseline rules from      â”‚  â•‘
â•‘  â”‚   building data (10th percentile)    â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                             â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘  â”‚ â˜‘ Data Completeness                 â”‚  â•‘
â•‘  â”‚   Detects missing data and          â”‚  â•‘
â•‘  â”‚   generates validation rules        â”‚  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                             â•‘
â•‘                                             â•‘
â•‘               [Cancel] [Apply]             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

## Result Example

After clicking [Apply], all rules appear in View Catalogue:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Rules Catalogue                    [9 rules]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search...                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                â”‚
â”‚ IFC_PARAM_DOOR_MIN_WIDTH_ABC      ğŸŸ  PSet     â”‚
â”‚  Door minimum width (extracted)                â”‚
â”‚  Parameters: min_width_mm: 900                 â”‚
â”‚  Severity: ERROR                               â”‚
â”‚  [âœ Edit] [ğŸ—‘ Delete]                         â”‚
â”‚                                                â”‚
â”‚ STAT_DOOR_WIDTH_10TH_PERCENTILE   ğŸŸ¡ Stat     â”‚
â”‚  Door width baseline                           â”‚
â”‚  Parameters: min_width_mm: 850                 â”‚
â”‚  Severity: WARNING                             â”‚
â”‚  Source: 10th percentile (6 samples)           â”‚
â”‚  [âœ Edit] [ğŸ—‘ Delete]                         â”‚
â”‚                                                â”‚
â”‚ METADATA_DOORS_MISSING_WIDTH      ğŸ”µ Meta     â”‚
â”‚  Doors missing width data                      â”‚
â”‚  Issue: 2 doors without width data             â”‚
â”‚  Recommendation: Add width property sets       â”‚
â”‚  [âœ Edit] [ğŸ—‘ Delete]                         â”‚
â”‚                                                â”‚
â”‚ ... (6 more rules)                            â”‚
â”‚                                                â”‚
â”‚ [Import]  [Append]  [Save]        [Close]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Now you can:**
1. âœ… Extract rules automatically using three strategies
2. âœ… Choose which strategies to use
3. âœ… View results in Rules Catalogue
4. âœ… Edit, delete, append, and save rules
5. âœ… Understand data quality through metadata rules
